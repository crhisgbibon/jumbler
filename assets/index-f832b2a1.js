var S=Object.defineProperty;var X=(n,e,t)=>e in n?S(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var B=(n,e,t)=>(X(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();function x(){let n=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",n+"px")}window.addEventListener("DOMContentLoaded",x);window.addEventListener("resize",x);window.addEventListener("orientationchange",x);class F{constructor(){B(this,"frag");B(this,"row",0);B(this,"column",0);B(this,"index",0)}}const H=document.getElementById("jumbleDiv"),r=document.getElementById("ctx"),m=r.getContext("2d"),Y=document.getElementById("completed"),v=document.getElementById("rows"),h=document.getElementById("columns");document.getElementById("myfile");const b=document.getElementById("uploadedFiles");b.onchange=function(){R()};document.getElementById("triggerSelectFileButton");const j=document.getElementById("fileupload");j.onchange=function(){q()};document.getElementById("clearFileSelectButton");const T=document.getElementById("originalButton");T.onclick=function(){K()};const W=document.getElementById("jumbleButton");W.onclick=function(){J()};const A=document.getElementById("settingsButton");A.onclick=function(){P()};const N=document.getElementById("loadSelected");N.onclick=function(){R(),P()};const M=document.getElementById("settingsMenu");M.style.display="none";let s,f,O,d,g,p=[],l=[],w=[],L=new Image,D=!1;function P(){D=!D,D?M.style.display="":M.style.display="none"}function q(){let n=document.getElementById("fileupload").files;function e(t){if(window.File&&window.FileReader&&window.FileList&&window.Blob){let a=new FileReader;a.addEventListener("load",function(){let o=document.createElement("img");o.src=this.result,w.push(o);let i=document.createElement("option");i.value=w.length-1,i.innerHTML=t.name,b.appendChild(i)},!1),a.readAsDataURL(t)}}if(n.length>0)for(let t=0;t<n.length;t++)e(n[t])}function R(){w.Length!=0&&(L.src=w[b.value].src,m.drawImage(L,0,0),z(L.src))}function z(n){let e=document.createElement("img");if(w.Length==0||n==null||n=="")return;e.src=n,r.width=e.width,r.height=e.height;let t=H.offsetWidth*.75,a=H.offsetHeight*.75,o=e.width,i=e.height;if(o>t){let u=100/r.width*t,c=r.height/100*u;e.width=t,e.height=c,r.width=t,r.height=c,m.drawImage(e,0,0,t,c)}else if(i>a){let u=100/r.height*a,c=r.width/100*u;e.width=c,e.height=a,r.width=c,r.height=a,m.drawImage(e,0,0,c,a)}else m.drawImage(e,0,0,e.width,e.height);if(s=e.width/v.value,f=e.height/h.value,O=v.value*h.value,l.length=0,p.length=0,r.width!==0){for(let u=0;u<v.value;u++)for(let c=0;c<h.value;c++){let E=m.getImageData(u*s,c*f,s,f),y=new F;y.index=l.length,y.row=u,y.column=c,y.frag=E,l.push(y);let I=new F;I.index=l.length,I.row=u,I.column=c,I.frag=E,p.push(I)}document.getElementById("originalImg").dataset.state="original"}}function J(){if(w.Length==0||l.length==0)return;let n=[],e=[];for(let t=0;t<O;t++)n.push(t);for(let t=0;t<v.value;t++)for(let a=0;a<h.value;a++){let o=Math.floor(Math.random()*n.length);e.push(l[n[o]].frag),n.splice(o,1)}for(let t=0;t<e.length;t++)l[t].frag=e[t],m.putImageData(l[t].frag,l[t].row*s,l[t].column*f);C(),document.getElementById("originalImg").dataset.state="jumbled"}function K(){if(w.Length==0)return;let n=document.getElementById("originalImg");if(n.dataset.state==="original"){for(let e=0;e<p.length;e++)m.putImageData(p[e].frag,p[e].row*s,p[e].column*f);n.dataset.state="jumbled"}else if(n.dataset.state==="jumbled"){for(let e=0;e<l.length;e++)m.putImageData(l[e].frag,l[e].row*s,l[e].column*f);n.dataset.state="original"}}function C(){let n=0;for(let t=0;t<l.length;t++)l[t].frag===p[t].frag&&n++;let e=Math.floor(100/l.length*n);Y.innerHTML=e.toString()+"%"}r.onmousedown=function(n){n.preventDefault();let e=r.getBoundingClientRect(),t=n.clientX-e.left,a=n.clientY-e.top,o=Math.floor(t/s),i=Math.floor(a/f);d=o*h.value+i};r.onmouseup=function(n){n.preventDefault();let e=r.getBoundingClientRect(),t=n.clientX-e.left,a=n.clientY-e.top,o=Math.floor(t/s),i=Math.floor(a/f);if(g=o*h.value+i,d!=g){m.putImageData(l[g].frag,l[d].row*s,l[d].column*f),m.putImageData(l[d].frag,l[g].row*s,l[g].column*f);let u=l[d].frag,c=l[g].frag;l[d].frag=c,l[g].frag=u}C()};r.ontouchstart=function(n){if(n.preventDefault(),n.touches!=null){let e=r.getBoundingClientRect(),t=n.touches[0]||n.changedTouches[0],a=t.pageX-e.left,o=t.pageY-e.top,i=Math.floor(a/s),u=Math.floor(o/f);d=i*h.value+u}};r.ontouchend=function(n){if(n.preventDefault(),n.touches!=null){let e=r.getBoundingClientRect(),t=n.touches[0]||n.changedTouches[0],a=t.pageX-e.left,o=t.pageY-e.top,i=Math.floor(a/s),u=Math.floor(o/f);if(g=i*h.value+u,d!=g){m.putImageData(l[g].frag,l[d].row*s,l[d].column*f),m.putImageData(l[d].frag,l[g].row*s,l[g].column*f);let c=l[d].frag,E=l[g].frag;l[d].frag=E,l[g].frag=c}C()}};
